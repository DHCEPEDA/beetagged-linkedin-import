<!-- MINIMAL SQUARESPACE TEST - Paste this in Code Injection Footer -->

<div id="beetagged-minimal" style="margin: 20px 0; padding: 20px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 8px; font-family: Arial, sans-serif;">
    <h3 style="margin: 0 0 15px 0; color: #333;">BeeTagged Connection Test</h3>
    <p>Status: <strong id="beetagged-status">Testing...</strong></p>
    <p>Contacts: <strong id="beetagged-contacts">Loading...</strong></p>
    <button onclick="beetaggedTest()" style="padding: 8px 16px; background: #007cba; color: white; border: none; border-radius: 4px; cursor: pointer;">Test Connection</button>
    <div id="beetagged-result" style="margin-top: 15px; padding: 10px; background: white; border-radius: 4px; min-height: 20px;"></div>
</div>

<script>
(function() {
    console.log('BeeTagged minimal test loading...');
    
    window.beetaggedTest = async function() {
        const statusEl = document.getElementById('beetagged-status');
        const contactsEl = document.getElementById('beetagged-contacts');
        const resultEl = document.getElementById('beetagged-result');
        
        if (statusEl) statusEl.textContent = 'Connecting...';
        if (resultEl) resultEl.innerHTML = 'Testing backend connection...';
        
        try {
            const response = await fetch('https://beetagged-app-53414697acd3.herokuapp.com/health', {
                method: 'GET',
                mode: 'cors',
                headers: { 'Accept': 'application/json' }
            });
            
            if (response.ok) {
                const data = await response.json();
                console.log('BeeTagged backend response:', data);
                
                if (statusEl) statusEl.textContent = data.status || 'Connected';
                if (contactsEl) contactsEl.textContent = data.contacts || '0';
                if (resultEl) resultEl.innerHTML = 
                    '<div style="color: green;">✅ Backend connected successfully!</div>' +
                    '<div>Server: ' + (data.server || 'Unknown') + '</div>' +
                    '<div>Environment: ' + (data.environment || 'Unknown') + '</div>';
                
                // Test contact loading
                testContacts();
            } else {
                throw new Error('HTTP ' + response.status);
            }
        } catch (error) {
            console.error('BeeTagged connection error:', error);
            if (statusEl) statusEl.textContent = 'Error';
            if (resultEl) resultEl.innerHTML = '<div style="color: red;">❌ Connection failed: ' + error.message + '</div>';
        }
    };
    
    async function testContacts() {
        const resultEl = document.getElementById('beetagged-result');
        
        try {
            const response = await fetch('https://beetagged-app-53414697acd3.herokuapp.com/api/contacts', {
                method: 'GET',
                mode: 'cors',
                headers: { 'Accept': 'application/json' }
            });
            
            if (response.ok) {
                const contacts = await response.json();
                console.log('BeeTagged contacts loaded:', contacts.length);
                
                if (resultEl) {
                    resultEl.innerHTML += 
                        '<div style="color: green; margin-top: 10px;">✅ Loaded ' + contacts.length + ' contacts</div>' +
                        '<div>Ready for full widget deployment!</div>';
                }
            } else {
                throw new Error('HTTP ' + response.status);
            }
        } catch (error) {
            console.error('BeeTagged contacts error:', error);
            if (resultEl) {
                resultEl.innerHTML += '<div style="color: orange; margin-top: 10px;">⚠️ Contact loading failed: ' + error.message + '</div>';
            }
        }
    }
    
    // Auto-test when loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', window.beetaggedTest);
    } else {
        setTimeout(window.beetaggedTest, 100);
    }
})();
</script>