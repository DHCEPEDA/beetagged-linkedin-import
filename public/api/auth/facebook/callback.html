<!DOCTYPE html>
<html>
<head>
  <title>Facebook Auth Callback</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    pre {
      background-color: #f5f5f5;
      padding: 10px;
      border-radius: 4px;
      overflow: auto;
      white-space: pre-wrap;
    }
    .success {
      color: #155724;
      background-color: #d4edda;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .error {
      color: #721c24;
      background-color: #f8d7da;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .warning {
      color: #856404;
      background-color: #fff3cd;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 15px;
    }
  </style>
</head>
<body>
  <h1>Facebook Login Response</h1>
  <div id="result"></div>
  
  <h2>Raw URL Parameters:</h2>
  <pre id="params"></pre>
  
  <script>
    const resultEl = document.getElementById('result');
    const paramsEl = document.getElementById('params');
    
    // Parse URL parameters
    const params = new URLSearchParams(window.location.search);
    const code = params.get("code");
    const error = params.get("error");
    const state = params.get("state");
    
    // Show all parameters
    const allParams = {};
    params.forEach((value, key) => {
      allParams[key] = value;
    });
    paramsEl.textContent = JSON.stringify(allParams, null, 2);
    
    // Show result
    if (code) {
      resultEl.className = 'success';
      resultEl.innerHTML = `
        <p>✅ Success! Code received: ${code.substring(0, 10)}...</p>
        <p>This code can be exchanged for an access token.</p>
        <p>In a production app, this would be sent to your server for processing.</p>
      `;
      
      if (state) {
        resultEl.innerHTML += `<p>State parameter received: ${state}</p>`;
      }
    } else if (error) {
      resultEl.className = 'error';
      resultEl.innerHTML = `<p>❌ Error: ${error}</p>`;
      
      if (params.get("error_description")) {
        resultEl.innerHTML += `<p>Description: ${params.get("error_description")}</p>`;
      }
      
      if (params.get("error_reason")) {
        resultEl.innerHTML += `<p>Reason: ${params.get("error_reason")}</p>`;
      }
    } else {
      resultEl.className = 'warning';
      resultEl.innerHTML = `<p>⚠️ No code or error received.</p>
        <p>This page should only be accessed as a redirect from Facebook's OAuth flow.</p>`;
    }
    
    // Log to console for debugging
    console.log('Facebook OAuth callback received', {
      code: code ? `${code.substring(0, 10)}...` : 'none',
      error,
      state,
      fullParams: allParams
    });
  </script>
</body>
</html>